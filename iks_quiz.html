<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-g">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IKS Quiz Platform</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Load Heroicons for better UI -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for option buttons */
        .option-btn {
            transition: all 0.3s ease;
        }
        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        /* Styles for correct/wrong answers (Practice Mode / Review Mode) */
        .option-btn.correct {
            background-color: #16a34a !important; /* Tailwind green-600 */
            border-color: #15803d !important; /* Tailwind green-700 */
            color: white !important;
        }
        .option-btn.wrong {
            background-color: #dc2626 !important; /* Tailwind red-600 */
            border-color: #b91c1c !important; /* Tailwind red-700 */
            color: white !important;
        }
        /* Style for selected answer (Test Mode) */
        .option-btn.selected {
            background-color: #2563eb !important; /* Tailwind blue-600 */
            border-color: #1d4ed8 !important; /* Tailwind blue-700 */
            color: white !important;
        }
        .option-btn:disabled {
            opacity: 0.9;
            cursor: not-allowed;
        }

        /* Style for Mode Selection Cards */
        .mode-card {
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 160px; /* Ensure cards are same height */
        }
        .mode-card:hover {
            transform: scale(1.03);
        }
        .mode-card.selected {
            border-color: #3b82f6; /* Tailwind blue-500 */
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            background-color: #1f2937; /* Tailwind gray-800 */
        }
        
        /* Fade-in animation */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <!-- Main App Container -->
    <div id="app" class="w-full max-w-4xl">

        <!-- Start Screen -->
        <div id="start-screen" class="bg-gray-800 shadow-xl rounded-lg p-8 md:p-12 text-center fade-in">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-4">Indian Knowledge System</h1>
            <p class="text-xl md:text-2xl text-blue-300 mb-8">Quiz Platform</p>
            
            <!-- Unit Selection -->
            <div class="mb-6">
                <label for="unit-select" class="block text-sm font-medium text-gray-300 mb-2">1. Select a Unit</label>
                <select id="unit-select" class="w-full bg-gray-700 text-white border-2 border-gray-600 rounded-lg p-3">
                    <option value="unit2">Unit II: Engineering, Technology, and Architecture</option>
                    <option value="unit3">Unit III: (Add Your Questions)</option>
                    <option value="unit4">Unit IV: (Add Your Questions)</option>
                </select>
            </div>

            <!-- Mode Selection -->
            <div class="mb-8">
                <label class="block text-sm font-medium text-gray-300 mb-2">2. Choose a Mode</label>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Practice Mode Card -->
                    <div id="mode-practice" class="mode-card bg-gray-700 p-6 rounded-lg border-2 border-gray-600 selected flex flex-col justify-center items-center">
                        <ion-icon name="bulb-outline" class="text-4xl text-yellow-400 mb-2"></ion-icon>
                        <h3 class="text-xl font-semibold text-white">Practice Mode</h3>
                        <p class="text-gray-300 text-sm">Get instant feedback after each question.</p>
                    </div>
                    <!-- Test Mode Card -->
                    <div id="mode-test" class="mode-card bg-gray-700 p-6 rounded-lg border-2 border-gray-600 flex flex-col justify-center items-center">
                        <ion-icon name="document-text-outline" class="text-4xl text-red-400 mb-2"></ion-icon>
                        <h3 class="text-xl font-semibold text-white">Test Mode</h3>
                        <p class="text-gray-300 text-sm">Get your score and review at the end.</p>
                    </div>
                    <!-- Review Mode Card -->
                    <div id="mode-review" class="mode-card bg-gray-700 p-6 rounded-lg border-2 border-gray-600 flex flex-col justify-center items-center">
                        <ion-icon name="eye-outline" class="text-4xl text-green-400 mb-2"></ion-icon>
                        <h3 class="text-xl font-semibold text-white">Review Mode</h3>
                        <p class="text-gray-300 text-sm">View all questions with their answers.</p>
                    </div>
                </div>
            </div>

            <button id="start-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-12 rounded-lg text-lg shadow-lg transition-all duration-300 transform hover:scale-105">
                Start
            </button>
        </div>

        <!-- Quiz Screen (Hidden by default) -->
        <div id="quiz-screen" class="hidden bg-gray-800 shadow-xl rounded-lg p-6 md:p-10 max-w-3xl mx-auto">
            <!-- Progress -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span id="progress-text" class="text-sm font-medium text-blue-300">Question 1 / 85</span>
                    <span id="score-text-live" class="text-sm font-medium text-gray-300">Score: 0</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <!-- Question -->
            <h2 id="question-text" class="text-xl md:text-2xl font-semibold text-white mb-6" style="min-height: 6rem;">
                Question text goes here...
            </h2>

            <!-- Options -->
            <div id="options-container" class="space-y-3 mb-6">
                <!-- Option buttons will be injected here by JS -->
            </div>

            <!-- Feedback (Practice / Review Mode Only) -->
            <div id="feedback-area" class="hidden bg-gray-700 p-4 rounded-lg fade-in">
                <h3 id="feedback-title" class="text-lg font-bold mb-2"></h3>
                <p id="feedback-explanation" class="text-gray-200"></p>
            </div>

            <!-- Navigation -->
            <div class="mt-6 text-right">
                <button id="next-btn" class="hidden bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-8 rounded-lg transition-all duration-300">
                    Next
                </button>
            </div>
        </div>

        <!-- End Screen (Hidden by default) -->
        <div id="end-screen" class="hidden bg-gray-800 shadow-xl rounded-lg p-8 md:p-12 text-center fade-in max-w-3xl mx-auto">
            <h1 id="final-title" class="text-3xl md:text-4xl font-bold text-white mb-4">Quiz Complete!</h1>
            
            <!-- Score Section (Practice / Test Mode) -->
            <div id="score-section">
                <p class="text-xl text-gray-300 mb-6">Your final score is:</p>
                <h2 id="final-score-text" class="text-6xl font-extrabold text-blue-400 mb-2">30 / 85</h2>
                <p id="percentage-text" class="text-2xl font-medium text-white mb-8">(35%)</p>
                <p id="final-message" class="text-lg text-gray-300 mb-10">Keep practicing. You can do better!</p>
            </div>
            
            <!-- Review Section (Test Mode Only) -->
            <div id="review-container" class="hidden mt-12 text-left space-y-4">
                <h2 class="text-2xl font-bold text-white text-center mb-6">Review Your Answers</h2>
                <!-- Review items will be injected here -->
            </div>

            <button id="restart-btn" class="mt-8 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-12 rounded-lg text-lg shadow-lg transition-all duration-300 transform hover:scale-105">
                Back to Start
            </button>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- ALL QUIZ DATA ---
        const allQuizData = {
            unit2: [
                // Unit 2 data
                {
                    question: "___ is the scientific techniques and methods used to analyze substances like juices, dyes, paints, and cements?",
                    options: [ "Metallurgy", "Laboratory Technology", "Glass Technology", "Marine Technology" ],
                    answer: "Laboratory Technology",
                    explanation: "Laboratory Technology is the broad, scientific field that encompasses the methods and techniques used to analyze a wide variety of chemical and physical substances in a controlled setting."
                },
                {
                    question: "The process of creating objects from glass and pottery is known as ___",
                    options: [ "Metallurgy", "Painting", "Pottery", "Engineering Science and Technology" ],
                    answer: "Pottery",
                    explanation: "While the question incorrectly includes 'glass,' the process of creating objects from clay is known as Pottery. This is the most specific and correct craft listed among the options."
                },
                {
                    question: "___ is credited with the development of advanced metallurgical techniques",
                    options: [ "Sindhu Valley Civilization", "Vedic Age", "Mesopotamian Civilization", "Post-Vedic Record" ],
                    answer: "Sindhu Valley Civilization",
                    explanation: "The Sindhu Valley Civilization (Harappan) was a Bronze Age civilization and demonstrated significant metallurgical skill, particularly in smelting copper and alloying it with tin to create bronze."
                },
                {
                    question: "The famous engineering marvel found in Delhi that showcases the metallurgical expertise of ancient India",
                    options: [ "Iron Pillar of Delhi", "Rakhigarhi", "Mehrgarh", "Taj Mahal" ],
                    answer: "Iron Pillar of Delhi",
                    explanation: "The Iron Pillar of Delhi is a 7-meter-tall pillar from the Gupta period, renowned for its composition of 98% wrought iron and its remarkable resistance to rust for over 1,600 years."
                },
                {
                    question: "The archaeological site known as \"The Cradle of Indian Civilization\" is:",
                    options: [ "Sindhu Valley Civilization", "Rakhigarhi", "Mehrgarh", "Iron Pillar of Delhi" ],
                    answer: "Mehrgarh",
                    explanation: "Mehrgarh is one of the earliest known Neolithic sites in South Asia, showing evidence of farming and herding. It is considered a precursor to the later, urban Indus Valley Civilization, earning it this title."
                },
                {
                    question: "____is known for its advanced urban planning and sophisticated drainage systems.",
                    options: [ "Indus Valley Civilization", "Egyptian Civilization", "Roman Civilization", "Mesopotamian Civilization" ],
                    answer: "Indus Valley Civilization",
                    explanation: "A hallmark of the Indus Valley Civilization was its meticulously planned cities, featuring grid-like street patterns and the world's first known urban sanitation systems with covered drains."
                },
                {
                    question: "The early urban center of the Indus Valley Civilization is represented by which archaeological site?",
                    options: [ "Mehrgarh", "Mohenjo-daro", "Harappa", "Lothal" ],
                    answer: "Harappa",
                    explanation: "Harappa was one of the first and largest cities of the civilization to be excavated, giving the entire civilization its alternate name (Harappan Civilization). It is a prime example of its urban phase."
                },
                {
                    question: "____ civilization is famous for its mastery of dyeing techniques",
                    options: [ "Indus Valley", "Mayan", "Egyptian", "Roman" ],
                    answer: "Indus Valley",
                    explanation: "Archaeological finds, such as scraps of cotton dyed with madder (a red dye), indicate that the Indus Valley people had mastered the art of dyeing textiles."
                },
                {
                    question: "In ancient civilizations _____ is used to bind bricks together in their construction.",
                    options: [ "Lime", "Cement", "Mud", "Sand" ],
                    answer: "Mud",
                    explanation: "Mud mortar was the most common and widely available binding agent used in ancient brick construction (both sun-dried and baked bricks) across many civilizations, including the Indus Valley."
                },
                {
                    question: "The ancient art of glassmaking was highly developed in _____ civilization.",
                    options: [ "Roman", "Indus Valley", "Mayan", "Egyptian" ],
                    answer: "Egyptian",
                    explanation: "The ancient Egyptians were pioneers in glassmaking, developing techniques for creating faience (a pre-glass glaze) and later, core-formed glass vessels and intricate beads."
                },
                {
                    question: "_____ is the process of baking clay to create pottery.",
                    options: [ "Ceramics", "Sculpting", "Firing", "Glazing" ],
                    answer: "Firing",
                    explanation: "Firing is the term for heating clay in a kiln to a high temperature. This process causes permanent chemical and physical changes that turn the soft clay into hard, durable pottery."
                },
                {
                    question: "____ element contributes to resistance in metallurgical composition.",
                    options: [ "Phosphorus", "Copper", "Gold", "Silver" ],
                    answer: "Phosphorus",
                    explanation: "Copper, gold, and silver are excellent conductors (low resistance). Phosphorus is often an impurity or an additive that increases hardness and electrical resistance. The high phosphorus content of the Iron Pillar of Delhi also contributes to its rust resistance."
                },
                {
                    question: "The earliest known example of the extraction of zinc from its ore was found in ____civilization.",
                    options: [ "Indus Valley", "Mayan", "Egyptian", "Roman" ],
                    answer: "Indus Valley",
                    explanation: "Ancient India (within the broad sphere of the Indus Valley and later Indian cultures) is renowned for pioneering zinc metallurgy. The Zawar mines in Rajasthan provide evidence of industrial-scale zinc distillation."
                },
                {
                    question: "The Vedic texts provide insights into ancient Indian knowledge on _____ .",
                    options: [ "Astronomy and Mathematics", "Textile Manufacturing", "Shipbuilding", "Glassmaking" ],
                    answer: "Astronomy and Mathematics",
                    explanation: "The Vedas and their ancillary texts (Vedangas) contain detailed information on astronomy (Jyotisha, for tracking celestial bodies) and mathematics (Sulbasutras, for geometric altar construction)."
                },
                {
                    question: "The Arthashastra, an ancient Indian treatise, discusses topics related to _____",
                    options: [ "Statecraft and Economics", "Yoga and Meditation", "Architecture and Engineering", "Sculpture and Artistry" ],
                    answer: "Statecraft and Economics",
                    explanation: "Kautilya's Arthashastra is a foundational text on political science, detailing how to run a state, manage its economy, conduct military strategy, and administer justice."
                },
                {
                    question: "The Iron Pillar of Delhi is associated with which historical period?",
                    options: [ "Gupta Empire", "Mughal Empire", "Mauryan Empire", "Chola Dynasty" ],
                    answer: "Gupta Empire",
                    explanation: "The inscription on the pillar mentions a king named 'Chandra,' who is identified by historians as Emperor Chandragupta II of the Gupta Empire (circa 4th-5th century CE)."
                },
                {
                    question: "What makes the Iron Pillar of Delhi unique in terms of its metallurgy?",
                    options: [ "It is remarkably resistant to rust due to its composition", "It is a pure iron structure", "It was cast using advanced forging techniques", "It is made entirely of gold" ],
                    answer: "It is remarkably resistant to rust due to its composition",
                    explanation: "The pillar's fame comes from its remarkable resistance to rust. This is attributed to its high phosphorus content, low sulfur, and the formation of a passive, protective film on its surface."
                },
                {
                    question: "Rakhigarhi and Mehrgarh are associated with ____ civilization.",
                    options: [ "Indus Valley", "Mayan", "Egyptian", "Sumerian" ],
                    answer: "Indus Valley",
                    explanation: "Mehrgarh is a key precursor site, and Rakhigarhi is one of the largest mature cities of the Indus Valley Civilization, both located in the Indian subcontinent."
                },
                {
                    question: "What does the archaeological site of Rakhigarhi reveal about the Indus Valley Civilization?",
                    options: [ "Evidence of urban planning and settlement", "Maritime trade routes", "Hieroglyphic writing system", "Advanced pottery techniques" ],
                    answer: "Evidence of urban planning and settlement",
                    explanation: "As one of the largest Harappan cities, Rakhigarhi provides extensive evidence of urban planning, including planned streets, drainage systems, and distinct residential and public areas."
                },
                {
                    question: "The ancient Harappans have engaged in maritime trade with _____region.",
                    options: [ "Mesopotamia", "Africa", "South America", "Scandinavia" ],
                    answer: "Mesopotamia",
                    explanation: "There is strong evidence, including Harappan seals found in Mesopotamian sites (like Ur) and Mesopotamian texts mentioning trade with 'Meluhha' (believed to be the Indus Valley), of a trade link with Mesopotamia."
                },
                {
                    question: "________ advanced engineering technique allowed ancient civilizations to construct seaworthy boats and ships.",
                    options: [ "Sewn Plank Technique", "Stone Carving", "Adobe Construction", "Thatch Roofing" ],
                    answer: "Sewn Plank Technique",
                    explanation: "The Sewn Plank Technique, where planks of a ship's hull are 'sewn' or tied together, was a widespread and effective method of shipbuilding used in the Indian Ocean and other regions."
                },
                {
                    question: "The cities of the Indus Valley Civilization were known for their _____",
                    options: [ "Rectangular street patterns", "Spiral street patterns", "Circular streets", "Random street patterns" ],
                    answer: "Rectangular street patterns",
                    explanation: "Harappan cities like Mohenjo-daro and Harappa were built on a grid, with main streets running north-south and east-west, creating rectangular street patterns and blocks."
                },
                {
                    question: "_______ language is believed to be associated with Harappan scripts.",
                    options: [ "Dravidian", "Indo-European", "Sino-Tibetan", "Semitic" ],
                    answer: "Dravidian",
                    explanation: "While the Harappan script is still undeciphered, a leading hypothesis, based on linguistic analysis, suggests it represents an early form of a Dravidian language."
                },
                {
                    question: "What type of laboratory apparatus was commonly used in ancient civilizations for distillation and extraction?",
                    options: [ "Alembic", "Microscope", "Telescope", "Thermometer" ],
                    answer: "Alembic",
                    explanation: "An Alembic is an early form of distillation apparatus, consisting of a bulbous base and a cap with a tube, used by ancient chemists and alchemists to distill substances."
                },
                {
                    question: "______ was commonly used to create the color red during civilization.",
                    options: [ "Iron Oxide", "Copper Sulfate", "Zinc Oxide", "Lead Carbonate" ],
                    answer: "Iron Oxide",
                    explanation: "Iron Oxide, found naturally as the mineral ochre, is one of the oldest and most common pigments used by humans to create red, yellow, and brown colors."
                },
                {
                    question: "Ancient glassmakers often used _____ material to create glass.",
                    options: [ "Silica", "Gold", "Platinum", "Uranium" ],
                    answer: "Silica",
                    explanation: "The primary and essential ingredient for all glass is Silica (silicon dioxide), which is most commonly sourced from sand."
                },
                {
                    question: "What is the primary difference between earthenware and stoneware pottery?",
                    options: [ "Firing temperature", "Decorative patterns", "Clay composition", "Glazing techniques" ],
                    answer: "Firing temperature",
                    explanation: "The defining difference is the firing temperature. Earthenware is fired at lower temperatures (making it porous), while stoneware is fired at very high temperatures until the clay vitrifies (becomes non-porous)."
                },
                {
                    question: "______is the process of adding a thin layer of zinc to iron or steel to prevent corrosion",
                    options: [ "Galvanizing", "Forging", "Alloying", "Tempering" ],
                    answer: "Galvanizing",
                    explanation: "This is the definition of Galvanizing, where a sacrificial coating of zinc is applied to iron or steel to protect it from rust."
                },
                {
                    question: "The ancient technique of lost-wax casting was used for creating ________",
                    options: [ "Metal Sculptures", "Textiles", "Glassware", "Pottery" ],
                    answer: "Metal Sculptures",
                    explanation: "The lost-wax technique (cire perdue) is a process for creating detailed metal sculptures. A wax model is encased in clay, the wax is melted out, and molten metal is poured into the hollow mold."
                },
                {
                    question: "The concept of \"Vimana\" mentioned in ancient texts is associated with _____",
                    options: [ "Aircraft-like vehicles", "Boats", "Temples", "Forts" ],
                    answer: "Aircraft-like vehicles",
                    explanation: "In ancient Sanskrit epics like the Ramayana, 'Vimana' refers to mythical flying palaces or aircraft-like vehicles used by the gods."
                },
                {
                    question: "The Vedas, ancient Indian scriptures, contains ______",
                    options: [ "Mathematics and Astronomy", "Computer programming", "Modern physics", "Microbiology" ],
                    answer: "Mathematics and Astronomy",
                    explanation: "The Vedas and their associated texts contain extensive knowledge of mathematics (geometry in the Sulbasutras) and astronomy (Jyotisha)."
                },
                {
                    question: "The Iron Pillar of Delhi is inscribed with a Sanskrit inscription dedicated to______ deity",
                    options: [ "Vishnupad", "Shiva", "Rama", "Krishna" ],
                    answer: "Vishnupad",
                    explanation: "The inscription states the pillar was set up as a standard (dhvaja) in honor of the deity Vishnu, on a hill called Vishnupada ('Vishnu's footprint')."
                },
                {
                    question: "The Iron Pillar is currently located at ________historical site in Delhi",
                    options: [ "Qutub Complex", "Red Fort", "Humayun's Tomb", "India Gate" ],
                    answer: "Qutub Complex",
                    explanation: "The pillar stands in the courtyard of the Quwwat-ul-Islam Mosque, which is part of the Qutub Complex in Mehrauli, Delhi."
                },
                {
                    question: "________ is the ancient Indus Valley Civilization site which is considered one of the largest Harappan cities",
                    options: [ "Rakhigari", "Harappa", "Mohenjo-daro", "Lothal" ],
                    answer: "Rakhigari",
                    explanation: "Based on modern excavations and surveys, Rakhigari (Rakhigarhi) in Haryana is now considered to be the largest-known urban center of the Indus Valley Civilization."
                },
                {
                    question: "The archaeological site of Mehrgarh is situated in _______",
                    options: [ "Pakistan", "India", "Afghanistan", "Nepal" ],
                    answer: "Pakistan",
                    explanation: "Mehrgarh is located on the Kachi Plain in the Balochistan province of modern-day Pakistan."
                },
                {
                    question: "Ancient mariners often used _______ celestial navigation used to determine their position at sea. What celestial body was commonly used for this purpose",
                    options: [ "Stars", "Mars", "Moon", "Venus" ],
                    answer: "Stars",
                    explanation: "Ancient celestial navigation relied on the predictable positions of Stars. The Pole Star (like Polaris) was used to find direction (north), and the altitude of stars was used to determine latitude."
                },
                {
                    question: "_____ wind pattern is known for bringing heavy rains to the Indian subcontinent",
                    options: [ "Monsoons", "Polar easterlies", "Westerlies", "Trade winds" ],
                    answer: "Monsoons",
                    explanation: "The Monsoons are seasonal winds that reverse direction, bringing moisture-laden air from the Indian Ocean to the subcontinent, resulting in a heavy rainy season."
                },
                {
                    question: "_______river played a significant role in the development of the Indus Valley Civilization",
                    options: [ "Indus", "Nile", "Tigris", "Ganges" ],
                    answer: "Indus",
                    explanation: "The civilization is named after the Indus River. Its floodplains (along with the Ghaggar-Hakra river) provided fertile land for agriculture and served as a transportation route."
                },
                {
                    question: "________is the purpose of the Great Bath found at Mohenjo-Daro",
                    options: [ "Public bathing and ceremonial use", "Ritual sacrifice", "Drinking water storage", "Agricultural irrigation" ],
                    answer: "Public bathing and ceremonial use",
                    explanation: "The sophisticated construction and central location of the Great Bath strongly suggest it was not for simple hygiene but for public, ceremonial use, likely related to ritual purification."
                },
                {
                    question: "_____ civilization is known for its use of a sophisticated drainage system in urban planning",
                    options: [ "Indus Valley", "Mayan", "Egyptian", "Sumerian" ],
                    answer: "Indus Valley",
                    explanation: "The Indus Valley (Harappan) civilization is famous for its advanced, covered drainage and sanitation systems in its cities."
                },
                {
                    question: "The use of \"lime plaster\" in construction was prevalent in ______civilization",
                    options: [ "Indus Valley", "Mayan", "Egyptian", "Sumerian" ],
                    answer: "Indus Valley",
                    explanation: "The people of the Indus Valley civilization used both gypsum and lime-based plasters, most notably to waterproof the Great Bath at Mohenjo-Daro."
                },
                {
                    question: "______ is the name for the process of firing pottery at a high temperature to strengthen it",
                    options: [ "Baking", "Glazing", "Sculpting", "Tempering" ],
                    answer: "Baking",
                    explanation: "This process, also known as 'firing' (as in Q12), is essentially baking the clay in a kiln to permanently harden it."
                },
                {
                    question: "The technique of adding metallic oxides to pottery glazes to achieve specific colors is known as ________",
                    options: [ "Stoneware", "Porcelain", "Earthenware", "Majolica" ],
                    answer: "Majolica",
                    explanation: "Majolica (or Faience) is a specific pottery technique where a tin-glaze is applied and then painted with pigments, such as metallic oxides (e.g., cobalt for blue, copper for green), before a second firing."
                },
                {
                    question: "The Chola dynasty of ancient India is known for their expertise in ______ metal",
                    options: [ "Bronze", "Iron", "Gold", "Silver" ],
                    answer: "Bronze",
                    explanation: "The Chola period is famous for its exquisite Bronze sculptures created using the lost-wax method, especially the iconic images of Shiva as Nataraja."
                },
                {
                    question: "________is the process of separating metal from its ore by heating it",
                    options: [ "Smelting", "Alloying", "Forging", "Quenching" ],
                    answer: "Smelting",
                    explanation: "Smelting is the high-temperature process used to extract a base metal from its ore, using heat and a chemical reducing agent."
                },
                {
                    question: "The concept of \"Yantra\" in ancient texts refers to ________",
                    options: [ "Mechanical devices", "Healing herbs", "Meditation techniques", "Astronomical predictions" ],
                    answer: "Mechanical devices",
                    explanation: "The Sanskrit word 'Yantra' literally means 'instrument, machine, or mechanical device'. While it can also refer to mystical diagrams (a 'device' for meditation), in a technical context, it means a machine."
                },
                {
                    question: "The \"Sushruta Samhita\" is an ancient text known for its detailed information on _______",
                    options: [ "Surgery and Medicine", "Mathematics", "Agriculture", "Architecture" ],
                    answer: "Surgery and Medicine",
                    explanation: "The Sushruta Samhita is a foundational Sanskrit text on medicine, and it is especially famous for its highly detailed descriptions of surgical procedures, including plastic surgery, and surgical instruments."
                },
                {
                    question: "______ is the approximate height of the Iron Pillar of Delhi",
                    options: [ "7 meters", "5 meters", "3 meters", "15 meters" ],
                    answer: "7 meters",
                    explanation: "The total height of the pillar from its base is 7.21 meters (about 23 feet 8 inches), making 7 meters the correct approximation."
                },
                {
                    question: "The site of Rakhigarhi is located in _______ modern-day state of India",
                    options: [ "Punjab", "Rajasthan", "Haryana", "Gujarat" ],
                    answer: "Haryana",
                    explanation: "Rakhigarhi is a large Harappan site located in the Hisar district of Haryana, India."
                },
                {
                    question: "What is the significance of the site of Mehrgarh in the context of the Indus Valley Civilization?",
                    options: [ "It is one of the earliest agricultural settlements leading to urbanization", "It is home to the most advanced architecture", "It was the capital city", "It is the largest city of the civilization" ],
                    answer: "It is one of the earliest agricultural settlements leading to urbanization",
                    explanation: "Mehrgarh is significant because it is a Neolithic site that predates the Harappan cities. It shows the early transition to farming and herding, which laid the foundation for the subsequent urban civilization."
                },
                {
                    question: "The Iron Pillar of Delhi is made primarily of ______metal",
                    options: [ "Iron", "Pure Steel", "Silver", "Gold" ],
                    answer: "Iron",
                    explanation: "As its name suggests, the pillar is made of Iron—specifically, 98% wrought iron."
                },
                {
                    question: "The \"Konark Sun Temple\" in India is known for its architectural representation of _______celestial navigation tool",
                    options: [ "Chariot wheels", "Altitudes", "Compass", "Astrolabe" ],
                    answer: "Chariot wheels",
                    explanation: "The temple is designed as a colossal chariot for the Sun God, Surya. It features 24 intricately carved chariot wheels on its base, which also function as sophisticated sundials."
                },
                {
                    question: "Ancient maritime trade routes connected the Indus Valley Civilization with ____civilization",
                    options: [ "Mesopotamia", "Roman", "Egyptian", "Sumerian" ],
                    answer: "Mesopotamia",
                    explanation: "Strong evidence confirms maritime trade between the Indus Valley and Mesopotamia (which included the Sumerians)."
                },
                {
                    question: "_______is the purpose of the citadel mound in Indus Valley Civilization cities",
                    options: [ "Administrative and religious center", "Residential area", "Marketplace", "Agricultural fields" ],
                    answer: "Administrative and religious center",
                    explanation: "The 'citadel' was the raised, fortified area of Harappan cities. It housed major public structures like the Great Bath and granaries, indicating it was the administrative and religious center."
                },
                {
                    question: "The discovery of _______type of artifact at Harappan sites suggests a highly organized trade network",
                    options: [ "Seal", "Pottery shard", "Weapon", "Musical instrument" ],
                    answer: "Seal",
                    explanation: "The thousands of unique steatite Seals found were used to impress clay tokens on goods. This system of 'sealing' implies ownership and a highly organized system for managing trade."
                },
                {
                    question: "The Indus Valley Civilization is known for its use of _________",
                    options: [ "Brick-lined drains", "Gutter pipes", "Wooden channels", "Stone channels" ],
                    answer: "Brick-lined drains",
                    explanation: "A key feature of Harappan urban planning was their advanced sanitation system, which included covered, brick-lined drains running under the streets."
                },
                {
                    question: "The use of lime-based cement in construction was a characteristic of ______ civilization",
                    options: [ "Roman", "Mesopotamia", "Egyptian", "Sumerian" ],
                    answer: "Roman",
                    explanation: "While other civilizations used lime plaster, the Romans are famous for developing and mastering hydraulic, lime-based cement (Roman concrete), which allowed them to build massive, durable structures."
                },
                {
                    question: "Ancient glass beads found at Indus Valley Civilization sites were used for______",
                    options: [ "Trade and ornamentation", "Cooking", "Medicine", "Religious rituals" ],
                    answer: "Trade and ornamentation",
                    explanation: "Beads, whether of glass, stone, or shell, were widely used for personal adornment (jewelry, or ornamentation) and were valuable, easily portable items for trade."
                },
                {
                    question: "The potter's wheel revolutionized pottery-making in ancient times. Evidence of its early use found in _________",
                    options: [ "Indus Valley Civilization", "Roman Civilization", "Mesopotamia Civilization", "Egyptian Civilization" ],
                    answer: "Mesopotamia Civilization",
                    explanation: "The potter's wheel is believed to have been invented in Mesopotamia (Sumer) during the 4th millennium BCE, slightly before its widespread adoption in the Indus Valley and Egypt."
                },
                {
                    question: "______ was the primary source of copper for the Indus Valley Civilization's metallurgical activities",
                    options: [ "Ores from Rajasthan and Baluchistan", "Imported ores from Egypt", "Local riverbed deposits", "Copper-rich soil" ],
                    answer: "Ores from Rajasthan and Baluchistan",
                    explanation: "The Harappans sourced their copper primarily from the Khetri mines in the Aravalli hills of Rajasthan and from sites in Baluchistan."
                },
                {
                    question: "The alloy of copper and tin that played a crucial role in ancient metallurgy is known as ___",
                    options: [ "Bronze", "Brass", "Steel", "Iron" ],
                    answer: "Bronze",
                    explanation: "Bronze is the alloy of copper and tin. (Brass is copper and zinc)."
                },
                {
                    question: "The \"Arthashastra\" discusses various aspects of governance, including ________",
                    options: [ "Economic policies and administration", "Music and dance", "Religious rituals", "Poetry and literature" ],
                    answer: "Economic policies and administration",
                    explanation: "The Arthashastra is a manual on statecraft, focusing on economic policies (like taxation) and administration."
                },
                {
                    question: "The \"Sulaba Sutras\" are ancient texts that provide knowledge about ________",
                    options: [ "Geometry and mathematics for constructing altars", "Medical treatments", "Astrological predictions", "Musical instruments" ],
                    answer: "Geometry and mathematics for constructing altars",
                    explanation: "The Sulbasutras (or 'Sulaba Sutras') are appendices to the Vedas that give precise rules of geometry and mathematics for the construction of complex Vedic fire altars."
                },
                {
                    question: "The Iron Pillar of Delhi was originally erected in _______ historical site",
                    options: [ "Udayagiri", "Mohenjo-Daro", "Harappa", "Sarnath" ],
                    answer: "Udayagiri",
                    explanation: "The pillar's inscription mentions it was erected on 'Vishnupada' hill, which scholars identify with Udayagiri (near Vidisha, MP), a site with other major inscriptions of Chandragupta II."
                },
                {
                    question: "The inscription on the Iron Pillar mentions a king who belonged to _____ dynasty",
                    options: [ "Chandra", "Gupta", "Mughal", "Maurya" ],
                    answer: "Chandra",
                    explanation: "The inscription itself mentions a powerful king by the name of 'Chandra'. While he belonged to the Gupta dynasty, the name *in* the inscription is 'Chandra.'"
                },
                {
                    question: "The ancient city of Lothal was a prominent center for ______",
                    options: [ "Bead-making", "Textile manufacturing", "Iron smelting", "Trade and maritime activities" ],
                    answer: "Trade and maritime activities",
                    explanation: "Lothal's most famous feature is its large, brick-built dockyard, identifying it as a crucial port city for trade and maritime activities."
                },
                {
                    question: "The people of the Indus Valley Civilization are believed to have used a standardized system of weights and measures made of _______",
                    options: [ "Steatite", "Gold", "Copper", "Silver" ],
                    answer: "Steatite",
                    explanation: "While the iconic cube weights were most commonly made of chert (a hard stone), Steatite (soapstone) was used for *seals* and possibly some very small weights. Among the given options, it is the most plausible material listed."
                },
                {
                    question: "Ancient seafaring merchants relied on _______ natural phenomenon to navigate across long distances",
                    options: [ "Stars and constellations", "Magnetic compasses", "Sextants", "Clocks" ],
                    answer: "Stars and constellations",
                    explanation: "Ancient navigation before the invention of the compass relied on celestial navigation—using the positions of the stars and constellations (and the sun) to find direction and latitude."
                },
                {
                    question: "The construction of the ancient port city of Lothal showcases the Indus Valley Civilization's expertise in ______",
                    options: [ "Maritime trade and shipbuilding", "Monumental architecture", "Irrigation techniques", "Astronomy and observatories" ],
                    answer: "Maritime trade and shipbuilding",
                    explanation: "The large, sophisticated dockyard at Lothal is direct proof of their advanced capabilities in maritime trade and shipbuilding."
                },
                {
                    question: "_____advanced technique was used in the construction of the Great Bath of Mohenjo-Daro",
                    options: [ "Waterproofing using bitumen", "Marble carving", "Gold leaf application", "Timber framing" ],
                    answer: "Waterproofing using bitumen",
                    explanation: "To make the large tank hold water, the Harappan engineers lined the brick structure with gypsum mortar and a layer of natural tar, or bitumen, for waterproofing."
                },
                {
                    question: "The Indus Valley Civilization had a standardized system of weights and measures, with units based on ______body part",
                    options: [ "Cubit", "Foot", "Finger", "Palm" ],
                    answer: "Cubit",
                    explanation: "Rulers found at Harappan sites show graduated marks that correspond to linear units of measurement based on body parts, including a 'cubit' (elbow to fingertip) and a 'foot.'"
                },
                {
                    question: "The Indus Valley Civilization had an extensive trade network. _____evidence suggests their participation in long-distance trade",
                    options: [ "Exotic materials and artifacts", "Fossils", "Ancient coins", "Written contracts" ],
                    answer: "Exotic materials and artifacts",
                    explanation: "The strongest evidence for long-distance trade is the discovery of exotic materials (like lapis lazuli from Afghanistan) far from their origin, and Indus artifacts (like seals) found in distant lands like Mesopotamia."
                },
                {
                    question: "_______ laboratory apparatus was used for distillation and other chemical processes",
                    options: [ "Retort", "Alembic", "Test tube", "Pipette" ],
                    answer: "Alembic",
                    explanation: "An Alembic (or a Retort) is a type of distillation apparatus used in ancient and medieval chemistry."
                },
                {
                    question: "The Indus Valley Civilization was known for producing intricate pottery with designs using________",
                    options: [ "Stamping and incising", "Sculpting", "Casting", "Weaving" ],
                    answer: "Stamping and incising",
                    explanation: "Besides their famous black-on-red painted designs, Harappan pottery was also decorated by incising (cutting lines into the wet clay) and stamping (pressing objects) to create patterns."
                },
                {
                    question: "The pottery of the Indus Valley Civilization often featured _________animal motifs",
                    options: [ "Unicorn", "Horse", "Elephant", "Lion" ],
                    answer: "Unicorn",
                    explanation: "The 'unicorn' (a mythical, one-horned bull) is the most common animal motif found on Indus *seals*, and this iconography also appears on pottery. The horse is notably rare or absent."
                },
                {
                    question: "The \"Harappan tanged spearhead\" is an example of sophisticated metallurgy used for _____",
                    options: [ "Weapons", "Coins", "Jewelry", "Religious artifacts" ],
                    answer: "Weapons",
                    explanation: "A 'spearhead' is, by definition, the pointed tip of a spear, which is a type of weapon. The 'tang' is the part that inserts into the spear shaft."
                },
                {
                    question: "The Indus Valley Civilization's knowledge of metallurgy is evidenced by their ability to create _______",
                    options: [ "Copper-bronze alloys", "Solid gold objects", "Iron structures", "Platinum ornaments" ],
                    answer: "Copper-bronze alloys",
                    explanation: "The Harappans lived in the Bronze Age. Their most significant metallurgical achievement was the creation of copper-bronze alloys by mixing copper and tin, which produced a harder metal."
                },
                {
                    question: "The \"Aitareya Brahmana\" discusses various rituals, including those related to __________",
                    options: [ "Fire and sacrifices", "Farming techniques", "Medicine and healing", "Marriage ceremonies" ],
                    answer: "Fire and sacrifices",
                    explanation: "The Brahmanas are a category of Vedic texts that provide detailed instructions and explanations for the performance of complex rituals and fire sacrifices (Yajna)."
                },
                {
                    question: "The ancient Indian system of water harvesting and storage, known as \"tanka,\" was primarily used in __________region",
                    options: [ "Rajasthan", "Deccan Plateau", "Himalayas", "Gangetic Plain" ],
                    answer: "Rajasthan",
                    explanation: "A 'tanka' (or taanka) is a traditional underground cistern used to harvest and store rainwater, a method crucial for survival in the arid Thar Desert region of Rajasthan."
                },
                {
                    question: "The inscription on the Iron Pillar of Delhi mentions the accomplishments of _____Gupta king",
                    options: [ "Chandragupta II", "Ashoka the Great", "Samudragupta", "Harsha" ],
                    answer: "Chandragupta II",
                    explanation: "The king 'Chandra' mentioned in the inscription is identified by scholars as the Gupta Emperor Chandragupta II."
                },
                {
                    question: "______advanced technique was used to made the Iron Pillar from a single piece of iron",
                    options: [ "Forging", "Welding", "Casting", "Electroplating" ],
                    answer: "Forging",
                    explanation: "The pillar was not cast. It was built by forging (heating and hammering) lumps of hot wrought iron and hammer-welding them together, one by one, to form the massive column."
                },
                {
                    question: "The archaeological site of Dholavira, features _____unique hydraulic structure",
                    options: [ "Sophisticated water reservoirs", "Amphitheater", "Ziggurat", "Observatory" ],
                    answer: "Sophisticated water reservoirs",
                    explanation: "Dholavira, located in the arid Rann of Kutch, is famous for its exceptional hydraulic engineering. It had a complex system of sophisticated water reservoirs, channels, and dams to capture and store scarce rainwater."
                },
                {
                    question: "________type of seals was commonly used by the people of the Indus Valley Civilization",
                    options: [ "Stamp", "Coin", "Amulet", "Cylinder" ],
                    answer: "Stamp",
                    explanation: "The most characteristic Indus seals were square or rectangular stamp seals, which were pressed onto clay to leave an impression. Cylinder seals were common in Mesopotamia."
                },
                {
                    question: "The ancient port of Lothal had a unique dockyard with a structure known as _______",
                    options: [ "Double-walled dock", "Floating pontoon", "Lighthouse", "Drawbridge" ],
                    answer: "Double-walled dock",
                    explanation: "The large, rectangular basin at Lothal, identified as a dockyard, was a sophisticated, brick-lined structure, sometimes described as a double-walled dock to withstand hydraulic pressure."
                },
                {
                    question: "__________ship is believed to have been used by ancient sailors for maritime trade in the Indian Ocean",
                    options: [ "Sambuk", "Caravel", "Galleon", "Longship" ],
                    answer: "Sambuk",
                    explanation: "A Sambuk is a type of dhow, a traditional wooden sailing vessel with lateen sails, which was used for centuries for trade along the coasts of the Indian Ocean, Red Sea, and Persian Gulf. The other options are European ships from much later periods."
                }
            ],
            unit3: [
                // Add your Unit 3 questions here
                {
                    question: "This is a placeholder for Unit 3, Question 1. What is...?",
                    options: [ "Option A", "Option B", "Option C", "Option D" ],
                    answer: "Option A",
                    explanation: "This is the explanation for the Unit 3 placeholder question."
                }
            ],
            unit4: [
                // Add your Unit 4 questions here
                {
                    question: "This is a placeholder for Unit 4, Question 1. Who...?",
                    options: [ "Answer 1", "Answer 2", "Answer 3", "Answer 4" ],
                    answer: "Answer 2",
                    explanation: "This is the explanation for the Unit 4 placeholder question."
                }
            ]
        };


        // --- DOM Elements ---
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const endScreen = document.getElementById('end-screen');

        const unitSelect = document.getElementById('unit-select');
        const modePracticeBtn = document.getElementById('mode-practice');
        const modeTestBtn = document.getElementById('mode-test');
        const modeReviewBtn = document.getElementById('mode-review'); // New button
        const startBtn = document.getElementById('start-btn');
        
        const restartBtn = document.getElementById('restart-btn');
        const nextBtn = document.getElementById('next-btn');

        const progressText = document.getElementById('progress-text');
        const progressBar = document.getElementById('progress-bar');
        const scoreTextLive = document.getElementById('score-text-live');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');

        const feedbackArea = document.getElementById('feedback-area');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackExplanation = document.getElementById('feedback-explanation');

        const finalTitle = document.getElementById('final-title');
        const scoreSection = document.getElementById('score-section');
        const finalScoreText = document.getElementById('final-score-text');
        const percentageText = document.getElementById('percentage-text');
        const finalMessage = document.getElementById('final-message');
        const reviewContainer = document.getElementById('review-container');

        // --- STATE ---
        let currentQuizData = []; // Will hold the questions for the selected unit
        let currentMode = 'practice'; // 'practice', 'test', or 'review'
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = []; // To store answers for Test Mode

        // --- FUNCTIONS ---

        /**
         * Shuffles an array in place (Fisher-Yates algorithm).
         * @param {Array} array The array to shuffle.
         * @returns {Array} The shuffled array.
         */
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Sets the active quiz mode
         */
        function setMode(mode) {
            currentMode = mode;
            modePracticeBtn.classList.remove('selected');
            modeTestBtn.classList.remove('selected');
            modeReviewBtn.classList.remove('selected');
            scoreTextLive.classList.add('hidden'); // Hide score by default

            if (mode === 'practice') {
                modePracticeBtn.classList.add('selected');
                scoreTextLive.classList.remove('hidden'); // Show score for practice
            } else if (mode === 'test') {
                modeTestBtn.classList.add('selected');
            } else if (mode === 'review') {
                modeReviewBtn.classList.add('selected');
            }
        }

        /**
         * Starts the quiz: hides start screen, shows quiz screen, resets state.
         */
        function startQuiz() {
            const selectedUnit = unitSelect.value;
            currentQuizData = allQuizData[selectedUnit];
            
            // Check if unit has questions
            if (currentQuizData.length === 0) {
                alert("This unit does not have any questions yet. Please add questions to the 'allQuizData' object in the script.");
                return;
            }

            startScreen.classList.add('hidden');
            endScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');

            currentQuestionIndex = 0;
            score = 0;
            userAnswers = new Array(currentQuizData.length).fill(null); // Reset answers
            
            showQuestion();
            updateLiveScore();
        }

        /**
         * Displays the current question and SHUFFLED options.
         */
        function showQuestion() {
            // Reset feedback
            feedbackArea.classList.add('hidden');
            nextBtn.classList.add('hidden');
            nextBtn.textContent = 'Next'; // Reset button text

            // Get current question data
            const questionData = currentQuizData[currentQuestionIndex];

            // Update progress
            progressText.textContent = `Question ${currentQuestionIndex + 1} / ${currentQuizData.length}`;
            progressBar.style.width = `${((currentQuestionIndex + 1) / currentQuizData.length) * 100}%`;
            
            // Update question text
            questionText.textContent = questionData.question;

            // Clear old options and create new SHUFFLED ones
            optionsContainer.innerHTML = '';
            // Don't shuffle for review mode, but shuffle for practice/test
            const optionsToShow = (currentMode === 'review') 
                ? [...questionData.options] 
                : shuffle([...questionData.options]);

            optionsToShow.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'option-btn w-full bg-gray-700 hover:bg-gray-600 text-gray-200 text-left p-4 rounded-lg border-2 border-gray-600';
                
                if (currentMode === 'review') {
                    button.disabled = true; // Disable buttons in review mode
                    if (option === questionData.answer) {
                        button.classList.add('correct'); // Highlight correct answer
                    }
                } else {
                    button.onclick = () => selectAnswer(option, button); // Add click handler only for practice/test
                }
                optionsContainer.appendChild(button);
            });

            // Handle Review Mode specifics
            if (currentMode === 'review') {
                feedbackTitle.textContent = "Correct Answer & Explanation";
                feedbackTitle.className = "text-lg font-bold mb-2 text-green-400";
                feedbackExplanation.textContent = questionData.explanation;
                feedbackArea.classList.remove('hidden');
                nextBtn.classList.remove('hidden');
                if (currentQuestionIndex === currentQuizData.length - 1) {
                    nextBtn.textContent = 'Finish Review';
                }
            }
        }

        /**
         * Handles the user's answer selection (Practice and Test modes only).
         */
        function selectAnswer(selectedOption, buttonEl) {
            const questionData = currentQuizData[currentQuestionIndex];
            const correctAnswer = questionData.answer;

            // Disable all option buttons
            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = true;
            });

            if (currentMode === 'practice') {
                // --- Practice Mode Logic ---
                nextBtn.classList.remove('hidden');
                
                if (selectedOption === correctAnswer) {
                    score++;
                    buttonEl.classList.add('correct');
                    feedbackTitle.textContent = "Correct!";
                    feedbackTitle.className = "text-lg font-bold mb-2 text-green-400";
                } else {
                    buttonEl.classList.add('wrong');
                    feedbackTitle.textContent = "Incorrect";
                    feedbackTitle.className = "text-lg font-bold mb-2 text-red-400";
                    // Also show the correct answer
                    Array.from(optionsContainer.children).forEach(button => {
                        if (button.textContent === correctAnswer) {
                            button.classList.add('correct');
                        }
                    });
                }
                feedbackExplanation.textContent = questionData.explanation;
                feedbackArea.classList.remove('hidden');
                updateLiveScore();

            } else {
                // --- Test Mode Logic ---
                userAnswers[currentQuestionIndex] = selectedOption;
                buttonEl.classList.add('selected'); // Highlight selected answer
                nextBtn.classList.remove('hidden');
                if (currentQuestionIndex === currentQuizData.length - 1) {
                    nextBtn.textContent = 'Submit Quiz';
                }
            }
        }

        /**
         * Loads the next question or ends the quiz.
         */
        function nextQuestion() {
            // Check if we are at the end
            if (currentQuestionIndex === currentQuizData.length - 1) {
                showResults();
            } else {
                currentQuestionIndex++;
                showQuestion();
            }
        }
        
        /**
         * Updates the live score display (for Practice Mode).
         */
        function updateLiveScore() {
            scoreTextLive.textContent = `Score: ${score}`;
        }

        /**
         * Displays the final results screen.
         */
        function showResults() {
            quizScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            reviewContainer.classList.add('hidden'); // Hide review by default

            if (currentMode === 'review') {
                // --- Review Mode End Screen ---
                finalTitle.textContent = "Review Complete!";
                scoreSection.classList.add('hidden'); // Hide score section
                finalMessage.textContent = `You have reviewed all ${currentQuizData.length} questions. Great job!`;

            } else {
                // --- Practice or Test Mode End Screen ---
                scoreSection.classList.remove('hidden'); // Show score section
                finalTitle.textContent = "Quiz Complete!";

                // Calculate score *only* for Test Mode (Practice score is already live)
                if (currentMode === 'test') {
                    score = 0;
                    userAnswers.forEach((answer, index) => {
                        if (answer === currentQuizData[index].answer) {
                            score++;
                        }
                    });
                }
                
                // Display Score Summary
                const percentage = Math.round((score / currentQuizData.length) * 100);
                finalScoreText.textContent = `${score} / ${currentQuizData.length}`;
                percentageText.textContent = `(${percentage}%)`;

                if (percentage >= 90) {
                    finalMessage.textContent = "Outstanding! You are an expert!";
                } else if (percentage >= 75) {
                    finalMessage.textContent = "Excellent job! You really know your stuff.";
                } else if (percentage >= 50) {
                    finalMessage.textContent = "Good work! You've got a solid foundation.";
                } else {
                    finalMessage.textContent = "Keep practicing! You'll get there.";
                }

                // Display Review Section for Test Mode
                if (currentMode === 'test') {
                    reviewContainer.innerHTML = ''; // Clear old review
                    const reviewTitle = document.createElement('h2');
                    reviewTitle.className = 'text-2xl font-bold text-white text-center mb-6';
                    reviewTitle.textContent = 'Review Your Answers';
                    reviewContainer.appendChild(reviewTitle);

                    currentQuizData.forEach((question, index) => {
                        const userAnswer = userAnswers[index];
                        const isCorrect = userAnswer === question.answer;

                        const reviewItem = document.createElement('div');
                        reviewItem.className = `p-4 rounded-lg mb-4 ${isCorrect ? 'bg-gray-700' : 'bg-red-900 bg-opacity-30 border border-red-700'}`;
                        
                        let reviewHTML = `
                            <h4 class="font-semibold text-lg mb-3">Question ${index + 1}: ${question.question}</h4>
                            <p class="text-sm mb-1 ${isCorrect ? 'text-green-400' : 'text-red-400'}">
                                <ion-icon name="${isCorrect ? 'checkmark-circle' : 'close-circle'}" class="align-middle"></ion-icon>
                                Your answer: <strong>${userAnswer || 'No answer'}</strong>
                            </p>
                        `;
                        
                        if (!isCorrect) {
                            reviewHTML += `
                                <p class="text-sm mb-2 text-green-400">
                                    <ion-icon name="checkmark-circle-outline" class="align-middle"></ion-icon>
                                    Correct answer: F<strong>${question.answer}</strong>
                                </p>
                            `;
                        }
                        
                        reviewHTML += `<p class="text-sm text-gray-300 mt-2"><b>Explanation:</b> ${question.explanation}</p>`;
                        
                        reviewItem.innerHTML = reviewHTML;
                        reviewContainer.appendChild(reviewItem);
                    });
                    reviewContainer.classList.remove('hidden');
                }
            }
        }
        
        /**
         * Returns to the main start screen.
         */
        function goHome() {
            endScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
            // Reset mode to default
            setMode('practice');
        }

        // --- EVENT LISTENERS ---
        modePracticeBtn.addEventListener('click', () => setMode('practice'));
        modeTestBtn.addEventListener('click', () => setMode('test'));
        modeReviewBtn.addEventListener('click', () => setMode('review')); // New listener
        startBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', goHome); 

        // Set initial mode
        setMode('practice');

    </script>
</body>
</html>

